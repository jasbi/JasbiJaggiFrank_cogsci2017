---
title: "Rapid Acquisition of Disjunction from Prosody and Consistency"
bibliography: library.bib
csl: apa6.csl
document-params: "10pt, letterpaper"

author-information: > 
    \author{{\large \bf Masoud Jasbi} \\ \texttt{masoudj@stanford.edu} \\ Department of Linguistics \\ Stanford University
    \And {\large \bf Akshay Jaggi} \\ \texttt{ajaggi@stanford.edu} \\ Department of Linguistics \\ Stanford University
    \And {\large \bf Michael C. Frank} \\ \texttt{mcfrank@stanford.edu} \\ Department of Psychology \\ Stanford University
    }

abstract: 
    "You need to mention the conflict between the usage-based accounts and the nativist accounts. You need to say that the exclusivity of disjunction can be learned from prosody and inconsistency of the disjuncts themselves (e.g. dirty or clean). Consistent with the nativist account, we find that even though *or* is rare in child-directed speech compared to *and*, it is learned relatively quickly by children and produced at an adult rate by the age four.  We also show that consistent with usage-based accounts of learning, there is a consistent pattern between usage and interpretation that children can learn from."
    
keywords:
    "language acquisition; word learning; logical words; and; or; nativism; constructivism."
    
output: cogsci2016::cogsci_paper
---

```{r global_options, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(fig.width=3, fig.height=3, fig.crop = F, fig.pos = "tb", fig.path='figs/',
                      echo=F, warning=F, cache=F, message=F, sanitize = T)
```

```{r, libraries}
library(png)
library(grid)
library(ggplot2)
library(xtable)
library(knitr)
library(childesr)
library(tidyverse)
library(ggthemes)
library(lubridate)
library(magrittr)
library(tidyboot)
library(lme4)
library(lmerTest)
```

# Introduction

"James Bond producer says next 007 could be black **or** a woman", reported the social media and entertainment company LADbible in a tweet. A twitter user named Robert responded sarcastically with: "if only women could be black!" What in the producer's speech gave the impression that the next 007 could not be both black **and** a woman? The word *or* is associated with two interpretations: **inclusive**, and **exclusive**. A disjunction like "A or B" is inclusive when it is interpreted as "A or B or both". This is probably what LADbible meant when reporting the James Bond producer. However, "A or B" can also be interpreted as exclusive: "A or B but **not both**". Robert's response shows that he had an exclusive interpration of *or*. What factors determine the interpretation of *or* and how do children learn its meaning given this ambiguity?

A large body of research in linguistics and philosophy in the past 50 years has created a common consensus on the meaning of *or* (see @Aloni2016). Data on the interpretation of disjunction across different sentences, contexts, and even languages show that the core meaning of disjunction words such as *or* is **inclusive**. This is similar to the definition of disjunction in formal logics. The **exclusive** interpretation of *or* is the result of enhancing its inclusive semantics via other (extra-semantic) factors such as intonation [@pruitt2013interpretation], inconsistency of the options [@geurts2006exclusive], and pragmatic reasoning over the speaker's choice of *or* instead of *and* [@grice1975logicconvo]. In other words, interpreting a disjunciton is a complex process that needs to take into account the meaning of *or* as well as different structural and contextual factors that accompany it. How do we, as children, learn such a complex interpretive system?

There are two accounts of children's acquisition of disjunciton: a constructivist account, and a nativist account. Under the constructivist account, children learn the meaning of *or* by paying attention to how parents use it in different contexts. They form usage-rules and expand their usage repertoire as they grow up. The prediction is that children's production of *or* in children mirrors what they hear from parents. @morris2008logically found that *or* is much less frequent than *and* in parents' speech to children.  As predicted by the constructivist account, children also learn to produce *and* quickly while for *or* there is a gradual increase in production, possibly reaching the adult level at age five or six. In children's speech, *and* appears quickly and around the age 2 or 3 while it takes several years for *or* to appear. The faster acquisition of *and* is consistent with the constructivist theory that emphasizes frequency of usage in children's linguistic development. Morris also showed that the majority of *or* examples children hear are exclusive. He showed that consistent with the constructivist account, the majority of *or*s children produce are also exclusive. 

However, several comprehension studies of *or* in different linguistic contexts show that children between the ages of three and five interpret *or* as inclusive disjunction [@crain2012emergence]. This is a surprising finding given the previous finding that the majority of *or* examples children hear are exclusive. @crain2012emergence suggests that children rely on innate knowledge that the the disjunciton operator in their native language must have an inclusive meaning. More broadly, logical nativism argues that children have an innate knowledge that the connective words in their native langauge should refer to operators similar to those in first order logic. Exclusive disjunction is not an operator available  

Here we provide alternative answers to two puzzles raised in previous literature: 1. Production-Comprehension Discrepency: the production data suggests that learning *or* is a gradual and long process, possibly reaching an adult-like level at the age five or six. However, comprehension studies suggest that children have an adult-like understanding of *or* at the age of four or even three. 2. Exclusivity puzzle: even though the majority of *or* examples children hear are exclusive, comprehension studies show that children understand *or* as inclusive disjunction. How do children learn what they do not seem to hear?

The first study shows that despite (relatively) rare occurances of *or*, it is learned relatively quickly and between the ages of 2 and 4. The finding confirms the nativist  

Implications for future work.

# Study 1: Corpus Study

First, we conducted an exploratory and large scale investigation of *and* and *or* productions in parents and children. The goal of the study was to find out when children start producing these words and when they reach the adult rate of production. We conclude that children start producing *and* around 1.5 or 2 years of age, and *or* between the ages of 2 and 3. They reach the adult rate of production for *and* around 3 and for *or* around 4 or possibly earlier.

## Methods

```{r, childesdbImports, eval=FALSE, include=FALSE}
# This chunk uses the childesr package to import all English words from childes-db and create the processed files "raw_normalized" and "bySpeechAct_normalized"
# Since the file is too big, we only store two dataframes on github that are the results of running this chunk of code

# Import all words from childes-db
english_tokens <- get_tokens(collection = c("Eng-NA","Eng-UK"), 
                          corpus = NULL, 
                          role = c("target_child","Mother", "Father"),
                          age = NULL, 
                          sex = NULL, 
                          child = NULL,
                          token = "*")

#Convert and store children's age in years using the lubridate package
english_tokens$target_child_age_years <- 
  english_tokens$target_child_age %>% 
  duration("days") %>% 
  as.numeric("years")

#Take out data for the age range below 1 and above 6 years, this is because there is not much data in that range
english_tokens %<>% filter(target_child_age_years < 6, target_child_age_years > 1)

# Prepare the speech_act categories for this study based on the utterance_types in childes-db
# Categories: declarative, impertaive, question, and other
english_tokens$speech_act <-
  recode(english_tokens$utterance_type, 
         `broken for coding`="other",
          `imperative_emphatic` = "imperative",
         interruption = "other",
         `interruption question` = "question",
         `missing CA terminator` = "other",
         `no break TCU continuation` = "other",
         `question exclamation` = "question",
         `quotation next line` = "other",
         `quotation precedes` = "other",
         `self interruption` = "other",
         `self interruption question` = "question",
         `trail off` = "other",
         `trail off question` = "question"
         )

#####################################################################
## Now we're going to process the English words we have in "english_tokens" in two ways

######## 1. Just count all the instances of "and" and "or" and normalize them by the total number of words a speaker has said at a particular age (of the child)

# Group the tokens (words) by speaker role and the age of the child, count how many words for each speaker at each age
rawOverall_stats <-
  english_tokens %>%
  group_by(speaker_role, target_child_age_years) %>%
  summarize(total_freq = n())

# Group connective tokens by speaker and age of the child. count how many connective for each speaker at each age
rawConnective_stats <-
  english_tokens %>%
  filter(gloss=="and" | gloss=="or") %>%
  group_by(speaker_role, target_child_age_years, gloss) %>%
  summarize(freq = n())

# Normalize the connective count by dividing the connective frequency by the total word frequency for each speaker at each age
rawNormalized_stats <-
  full_join(rawConnective_stats, rawOverall_stats, by=c("speaker_role", "target_child_age_years")) %>%
  mutate(relFreq = freq / total_freq, relFreq_ppt = relFreq * 1000)

########## 2. Count all the instaces of "and" and "or" in DIFFERENT SPEECH ACTS and normalize them by THE TOTAL NUMBER OF WORDS IN SPEECH ACTS for each speaker at a particular age

#group the tokesn by speaker, age, and speech act, then count them
overall_stats <-
  english_tokens %>%
  group_by(speaker_role, speech_act, target_child_age_years) %>%
  summarize(total_freq = n())

# only take out "and" and "or"s, group them by speaker, age of the child, and speech act, count them
connective_stats <-
  english_tokens %>%
  filter(gloss=="and" | gloss=="or") %>%
  group_by(speech_act, speaker_role, target_child_age_years, gloss) %>%
  summarize(freq = n())

# now join the previous data frames together, divide the number of tokens in each group by the total number of words in that group
normalized_stats <-
  full_join(connective_stats, overall_stats, by=c("speech_act", "speaker_role", "target_child_age_years")) %>%
  mutate(relFreq = freq / total_freq, relFreq_ppt = relFreq * 1000)

########## Store both dataframes to be called later
write.csv(rawNormalized_stats, "2_processed_data/raw_normalized.csv")
write.csv(normalized_stats, "2_processed_data/bySpeechAct_normalized.csv")
```

We accessed the Child Language Data Exchange System (CHILDES, @macwhinney2000childes) via the online platform [childes-db](http://childes-db.stanford.edu/) and its associated R package childesr [@childesdb]. We extracted all instances of *and* and *or* from the English corpora (ENG-NA and ENG-UK). We limited our analysis to the data between one and six years because there is scarce data outside this age range. We computated the relative frequency of connective production by dividing the total number of *and*/*or* in the speech of fathers, mothers, and children at a particular age by the total number of words spoken at that age. We present the relative frequency as parts per thousand.

## Results

```{r importProcessedData}
rawNormalized <- read.csv("2_processed_data/raw_normalized.csv")
bySpeechAct_normalized <- read.csv("2_processed_data/bySpeechAct_normalized.csv")
```

In figure 1, we show the relative frequencies of *and* and *or* in the speech of parents and children between one and six years. It is important to note that the y-axes for *and* vs. *or* show different ranges. This is due to the big difference in the relative frequencies of *and* and *or*. In the speech of parents, *and* is produced around 20 times per thousand words while *or* is only produced around 2 times per thousand words. This confirms previous findings that *or* is much less frequent in child directed speech than a similar funciton word such as *and*.

```{r OverallConnectivePlots, fig.env="figure", fig.asp=0.7, fig.width=3.3, fig.show="hold", fig.pos="H", fig.cap= "The relative frequency of AND (top) and OR (bottom) per thousand words in the speech of fathers, mothers, and children between the ages of 1 and 6."}
rawNormalized %>%
  filter(gloss=="and") %>%
  ggplot(aes(target_child_age_years, relFreq_ppt, shape = speaker_role, color=speaker_role)) +
  geom_point(aes(), size=0.6) +
#  facet_grid(gloss, scales="free_y") +
  scale_y_continuous(limits = c(0, 75)) +
  scale_x_continuous(breaks=seq(1,6)) +
  labs(x = "", y="ANDs Per thousand words") +
  geom_smooth(aes(group = speaker_role, color=speaker_role), span=0.9) +
  scale_color_manual(values = c("seagreen3","seagreen", "darkblue")) +
  theme_few() +
  theme(legend.position=c(0.9, 0.8), text = element_text(size=9)) + 
  guides(shape=guide_legend(title=NULL), color=guide_legend(title=NULL))

rawNormalized %>%
  filter(gloss=="or") %>%
  ggplot(aes(target_child_age_years, relFreq_ppt, shape = speaker_role, color=speaker_role)) +
  geom_point(aes(), size=0.6) +
#  facet_grid(speech_act~gloss, scales="free_y") +
  scale_y_continuous(limits = c(0, 8)) +
  scale_x_continuous(breaks=seq(1,6)) +
  labs(x = "Child's Age (years)", y="ORs per thousand words") +
  geom_smooth(aes(group = speaker_role, color=speaker_role), span=0.9) +
  scale_color_manual(values = c("seagreen3","seagreen", "darkblue")) + 
  theme_few() +
  theme(legend.position=c(0.9, 0.8), text = element_text(size=9))+ 
  guides(shape=FALSE, color=FALSE)
```

*And* and *or* seem to show different developmental rajectories in the speech of children. For *and*, there is a rapid increase in its production between the ages of 1.5 and 3 before it reaches the adult rate around the age 3 and stay at that level until the age 6. For *or*, on the other hand, we see a slow incrase from the age 2 until the age 6 when it reaches the adult rate. This difference in the development of *and* & *or* production was attributed to the frequency of these items in child-directed speech. Since *and* is much more frequent than *or*, it is learned much faster than *or*. @morris2008logically argued that such patterns support the item-based and usage-based acquisition of logical words.

However, the analysis above does not control for other factors that can affect the production of words by children. An important factor to control for is the development of speech acts. While content words such as *dog* or *chair* may appear freely in different types of speech acts, function words are highly constrained by the type of speech acts they can appear in. For example, it is reasoable to assume that question words such as *how* and *why* are much more likey to occur in questions than statements (declaratives). If parent-child interaction is such that parents ask more questions than children, it is not surprising to find higher rates of *how* and *why* production in parents than children. Therefore, it is important to control for the speech act a function word appears in.

Figure 2 shows the relative frequencies of *and* and *or* in questions vs. declaratives, in the speech of parents and children between one and six years. Here, the relative frequency is computed by dividing the total number of *and*/*or* in a question/declarative in the speech of fathers, mothers, and children at a particular age, by the total number of words in a question/declarative spoken at that age. As before, we present the relative frequency as parts per thousand.

```{r byspeechActPlots, fig.env="figure", fig.asp=1, fig.width=3.3, fig.show="hold", fig.pos="H", fig.cap= "The relative frequency of AND (top) and OR (bottom) per thousand words in delcaratives and questions in the speech of fathers, mothers, and children between the ages of 1 and 6,"}
bySpeechAct_normalized %>%
  filter(speech_act == "declarative" | speech_act == "question", gloss=="and") %>%
  ggplot(aes(target_child_age_years, relFreq_ppt, shape=speaker_role, color = speaker_role)) +
  geom_point(aes(color=speaker_role), size=0.6) +
  facet_grid(speech_act~gloss, scales="free_y") +
  scale_y_continuous(limits = c(0, 60)) +
  scale_x_continuous(breaks=seq(1,6)) +
  labs(x = "", y="Per thousand words") +
  geom_smooth(aes(group = speaker_role, color=speaker_role), span=0.9) +
  scale_color_manual(values = c("seagreen3","seagreen", "darkblue")) + 
  theme_few() +
  theme(text = element_text(size=9)) + 
  guides(shape=FALSE, color=FALSE)

bySpeechAct_normalized %>%
  filter(gloss=="or", speech_act == "declarative" | speech_act == "question") %>%
  ggplot(aes(target_child_age_years, relFreq_ppt, shape=speaker_role, color = speaker_role)) +
  geom_point(aes(color=speaker_role), size=0.6) +
  facet_grid(speech_act~gloss, scales="free_y") +
  scale_y_continuous(limits = c(0,7)) +
  scale_x_continuous(breaks=seq(1,6)) +
  labs(x = "Age (years)", y="Per thousand words") +
  geom_smooth(aes(group = speaker_role, color=speaker_role), span=0.9) +
  scale_color_manual(values = c("seagreen3","seagreen", "darkblue")) + 
  theme_few() +
  theme(text = element_text(size=9)) + 
  guides(shape=FALSE, color=FALSE)
```

The results show similar developmental trajectories for the production of *and* and *or* in children. For both words, there is a relatively rapid incease in their frequency between the ages of 2 and 4 before reaching the parent rate at the age of 4 and staying at that rate until the age of 6. This pattern of production is consistent with the nativist observations that the acquisition of *and* and *or* is rapid and that children have an adult-like comprehension of these two connectives at the age 4. 


## Summary

And is a lot more frequent than or in child directed speech.

In the first six years, it appears that children reach the adult production rate for and but not or.

This is at least partly because or is more frequent in questions and children produce fewer questions than parents.

The developmental trajectory of connective production is best described as a quick increase in production between the ages of 2 and 4 and staying around the parents' rate between the ages 4 and 6. This is compatible with the comprehension studies which suggest children understand *and* and *or* by the age four. 

# Study 2: Annotation Study

Use standard APA citation format. Citations within the text should
include the author's last name and year. If the authors' names are
included in the sentence, place only the year in parentheses, as in
[-@NewellSimon1972a], but otherwise place the entire reference in
parentheses with the authors and year separated by a comma
[@NewellSimon1972a]. List multiple references alphabetically and
separate them by semicolons [@ChalnickBillman1988a; @NewellSimon1972a]. 
Use the et. al. construction only after listing all the authors to a
publication in an earlier reference and for citations with four or
more authors.

For more information on citations in R Markdown, see **[here](http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html#citations).**

## Footnotes

Indicate footnotes with a number\footnote{Sample of the first
footnote.} in the text. Place the footnotes in 9 point type at the
bottom of the page on which they appear. Precede the footnote with a
horizontal rule.\footnote{Sample of the second footnote.}

## Figures

All artwork must be very dark for purposes of reproduction and should
not be hand drawn. Number figures sequentially, placing the figure
number and caption, in 10 point, after the figure with one line space
above the caption and one line space below it. If necessary, leave extra white space at
the bottom of the page to avoid splitting the figure and figure
caption. You may float figures to the top or bottom of a column, or
set wide figures across both columns.

## Two-column images

You can read local images using png package for example and plot 
it like a regular plot using grid.raster from the grid package. 
With this method you have full control of the size of your image. **Note: Image must be in .png file format for the readPNG function to work.**

You might want to display a wide figure across both columns. To do this, you change the `fig.env` chunk option to `figure*`. To align the image in the center of the page, set `fig.align` option to `center`. To format the width of your caption text, you set the `num.cols.cap` option to `2`.

```{r 2-col-image, fig.env = "figure*", fig.pos = "h", fig.width=4, fig.height=2, fig.align = "center", set.cap.width=T, num.cols.cap=2, fig.cap = "This image spans both columns. And the caption text is limited to 0.8 of the width of the document."}
img <- png::readPNG("figs/walrus.png")
grid::grid.raster(img)
```

## One-column images

Single column is the default option, but if you want set it explicitly, set `fig.env` to `figure`. Notice that the `num.cols` option for the caption width is set to `1`.

```{r image, fig.env = "figure", fig.pos = "H", fig.align='center', fig.width=2, fig.height=2, set.cap.width=T, num.cols.cap=1, fig.cap = "One column image."}
img <- png::readPNG("figs/lab_logo_stanford.png")
grid::grid.raster(img)
```


## R Plots

You can use R chunks directly to plot graphs. And you can use latex floats in the
fig.pos chunk option to have more control over the location of your plot on the page. For more information on latex placement specifiers see **[here](https://en.wikibooks.org/wiki/LaTeX/Floats,_Figures_and_Captions)**

```{r plot, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=2, fig.height=2, fig.cap = "R plot" }
x <- 0:100
y <- 2 * (x + rnorm(length(x), sd = 3) + 3)

ggplot2::ggplot(data = data.frame(x, y), 
       aes(x = x, y = y)) + 
  geom_point() + 
  geom_smooth(method = "lm")
```


## Tables

Number tables consecutively; place the table number and title (in
10 point) above the table with one line space above the caption and
one line space below it, as in Table 1. You may float
tables to the top or bottom of a column, set wide tables across both
columns.

You can use the xtable function in the xtable package.

```{r xtable, results="asis"}
n <- 100
x <- rnorm(n)
y <- 2*x + rnorm(n)
out <- lm(y ~ x)

tab1 <- xtable::xtable(summary(out)$coef, digits=c(0, 2, 2, 1, 2), 
                      caption = "This table prints across one column.")

print(tab1, type="latex", comment = F, table.placement = "H")
```

# Conclusion (Masoud)

List what you showed and argued for.

Talk about future directions.

Possibly talk about the original tweet and how that falls still outside what your algorithm learns.
# Acknowledgements

Place acknowledgments (including funding information) in a section at
the end of the paper.

# References 

```{r}
# References will be generated automatically by Pandoc and included here.
# The following code is some latex to format the bibliography. Do not remove it.
```


```{r localImport, include=FALSE, eval=FALSE}
# read the file containing all the "and" and "or" tokens
connective_tokens <- read.csv("1_raw_data/connective_tokens.csv")
# Read the file on speaker statistics in Childes English corpora
speaker_stats <- read.csv("1_raw_data/speaker_stats.csv")

# Make the tokens case insensitive
connective_tokens$gloss %<>% tolower()

# add age in years to the tokens dataframe
connective_tokens$target_child_age_years <- 
  connective_tokens$target_child_age %>% 
  duration("days") %>% 
  as.numeric("years")

# Excluding data from children young than 1 and older than 7
connective_tokens %<>% filter(target_child_age_years < 6, target_child_age_years > 1)

# add age in years to the speaker dataframe
speaker_stats$target_child_age_years <- 
  speaker_stats$target_child_age %>% 
  duration("days") %>% 
  as.numeric("years")

# create a table of token frequency at different ages by different speakers
speaker_info <- 
  speaker_stats %>%
  group_by(speaker_role, target_child_age_years) %>%
  summarize(total_token = sum(num_tokens))
```

```{r connectiveByAgeSpeaker, include=FALSE, eval=FALSE}
connective_ByAgeSpeaker <-
  connective_tokens %>%
  group_by(target_child_age_years, speaker_role, gloss) %>%
  summarise(freq = n()) %>%
  full_join(speaker_info, by = c("target_child_age_years", "speaker_role")) %>%
  mutate(ppm = (freq / total_token) * 1000) %>%
  na.omit()
```

```{r questionDeclarative, include=FALSE, eval=FALSE}
connective_byUtteranceAgeRole <-
  connective_tokens %>%
  group_by(target_child_age_years, speaker_role, gloss, utterance_type) %>%
  summarise(freq = n()) %>%
  filter(utterance_type == "declarative" | utterance_type == "question")

# normalize by the total number of tokens provided by speakers
allTokens_byRoleAgeUtterance <-
  read.csv("1_raw_data/allTokens_byRoleAgeUtterance.csv") %>%
  select(target_child_age, freq_total, speaker_role, utterance_type) %>%
  filter(utterance_type == "declarative" | utterance_type == "question")

allTokens_byRoleAgeUtterance$target_child_age_years <- 
  allTokens_byRoleAgeUtterance$target_child_age %>% 
  duration("days") %>% 
  as.numeric("years")

connective_normalized <-
  full_join(connective_byUtteranceAgeRole, allTokens_byRoleAgeUtterance, 
            by = c("target_child_age_years", "speaker_role", "utterance_type")) %>%
  mutate(ppm = (freq / freq_total) * 1000)
```

\setlength{\parindent}{-0.1in} 
\setlength{\leftskip}{0.125in}
\noindent
